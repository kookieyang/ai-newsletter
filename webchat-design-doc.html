<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebChat UI Enhancement â€” Design Document</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #f5f5f5;
      color: #333;
      line-height: 1.6;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 60px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    h1 {
      font-size: 32px;
      color: #1a1a2e;
      margin-bottom: 8px;
      border-bottom: 3px solid #4fc3f7;
      padding-bottom: 16px;
    }
    
    .meta {
      color: #666;
      font-size: 14px;
      margin-bottom: 40px;
    }
    
    h2 {
      font-size: 24px;
      color: #1a1a2e;
      margin-top: 40px;
      margin-bottom: 20px;
      padding-left: 16px;
      border-left: 4px solid #4fc3f7;
    }
    
    h3 {
      font-size: 18px;
      color: #333;
      margin-top: 28px;
      margin-bottom: 12px;
    }
    
    p {
      margin-bottom: 16px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
    }
    
    th {
      background: #1a1a2e;
      color: white;
      font-weight: 600;
    }
    
    tr:nth-child(even) {
      background: #f9f9f9;
    }
    
    .priority-high { color: #e74c3c; font-weight: 600; }
    .priority-medium { color: #f39c12; font-weight: 600; }
    
    .image-container {
      margin: 30px 0;
      text-align: center;
      background: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
    }
    
    .image-container img {
      max-width: 100%;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .image-caption {
      margin-top: 12px;
      font-size: 13px;
      color: #666;
      font-style: italic;
    }
    
    .code-block {
      background: #f4f4f4;
      border-left: 4px solid #4fc3f7;
      padding: 16px;
      margin: 20px 0;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 13px;
      overflow-x: auto;
      border-radius: 0 4px 4px 0;
    }
    
    .key-point {
      background: #e8f6ff;
      border-left: 4px solid #4fc3f7;
      padding: 16px 20px;
      margin: 20px 0;
      border-radius: 0 4px 4px 0;
    }
    
    .key-point strong {
      color: #1a1a2e;
    }
    
    ul, ol {
      margin: 16px 0;
      padding-left: 24px;
    }
    
    li {
      margin-bottom: 8px;
    }
    
    .status-badge {
      display: inline-block;
      background: #f39c12;
      color: white;
      padding: 4px 12px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    
    .comparison-box {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      border: 2px solid #e0e0e0;
    }
    
    .comparison-box.before {
      border-color: #e74c3c;
    }
    
    .comparison-box.after {
      border-color: #27ae60;
    }
    
    .comparison-box h4 {
      margin-bottom: 12px;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .comparison-box.before h4 { color: #e74c3c; }
    .comparison-box.after h4 { color: #27ae60; }
    
    .flow-diagram {
      background: #f9f9f9;
      padding: 24px;
      border-radius: 8px;
      margin: 20px 0;
      font-family: monospace;
      font-size: 13px;
      line-height: 2;
    }
    
    .footer {
      margin-top: 60px;
      padding-top: 20px;
      border-top: 2px solid #eee;
      text-align: center;
      color: #999;
      font-size: 13px;
    }
    
    @media print {
      body { background: white; }
      .container { box-shadow: none; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>WebChat UI Enhancement â€” Design Document</h1>
    <p class="meta">
      <strong>Date:</strong> February 28, 2026 | 
      <strong>Status:</strong> <span class="status-badge" style="background: #27ae60;">Design Approved</span> | 
      <strong>Session:</strong> WebChat | 
      <strong>Ready for:</strong> Sub-Task 1 Implementation
    </p>

    <h2>1. Overview</h2>
    <p>
      Enhance the WebChat interface to support rich media messaging (images, voice, video) 
      and improve text input UX. The goal is a unified composer that handles all message 
      types seamlessly.
    </p>

    <div class="key-point">
      <strong>Core Principle:</strong> One input area handles everything â€” text, files, and voice. 
      No mode switching, no complexity. Just type, attach, or record.
    </div>

    <h2>2. Requirements</h2>
    <table>
      <tr>
        <th>#</th>
        <th>Requirement</th>
        <th>Priority</th>
      </tr>
      <tr>
        <td>1</td>
        <td>Send pictures, voice, and video to AI</td>
        <td><span class="priority-high">High</span></td>
      </tr>
      <tr>
        <td>2</td>
        <td>Mixed text + media in one message (e.g., screenshot + bug description)</td>
        <td><span class="priority-high">High</span></td>
      </tr>
      <tr>
        <td>3</td>
        <td>Enter = new line, Ctrl+Enter = send message</td>
        <td><span class="priority-high">High</span></td>
      </tr>
      <tr>
        <td>4</td>
        <td>Voice message type (record & send audio)</td>
        <td><span class="priority-medium">Medium</span></td>
      </tr>
    </table>

    <h2>3. UI Mockups</h2>

    <h3>3.1 Input Bar â€” Bottom Composer</h3>
    <p>
      The new input bar combines attachment buttons, multi-line text area, and send button 
      in one unified interface. Users can type, attach files, or record voice without switching modes.
    </p>
    <div class="image-container">
      <img src="./2026-02-28-webchat-input-bar.png" alt="Input Bar Mockup">
      <p class="image-caption">Figure 1: Input bar with attachment buttons (ðŸ“Ž File, ðŸŽ¤ Voice, ðŸŽ¥ Video), 
      multi-line text area, and send button. Hint text shows "Ctrl+Enter to send".</p>
    </div>

    <h3>3.2 Attachment Preview â€” Mixed Content</h3>
    <p>
      When files are selected, they appear in an attachment preview area above the text input. 
      Users can see thumbnails, file names, sizes, and remove attachments if needed. 
      Text can be typed alongside attachments.
    </p>
    <div class="image-container">
      <img src="./2026-02-28-webchat-attachments.png" alt="Attachment Preview Mockup">
      <p class="image-caption">Figure 2: Attachment preview showing image and video thumbnails 
      with remove buttons, above the multi-line text input area.</p>
    </div>

    <h3>3.3 Voice Recording Interface</h3>
    <p>
      Voice recording happens inline. Users click the microphone button, see a recording 
      interface with timer and waveform, then choose to send or cancel.
    </p>
    <div class="image-container">
      <img src="./2026-02-28-webchat-voice-recording.png" alt="Voice Recording Mockup">
      <p class="image-caption">Figure 3: Voice recording interface with pulsing red indicator, 
      timer (0:05), audio waveform visualization, and Stop/Send/Cancel buttons.</p>
    </div>

    <h3>3.4 Message Display â€” Rich Content</h3>
    <p>
      Sent messages display with inline media previews. Images show as thumbnails that can 
      be clicked to expand. Text appears below or alongside media in the same bubble.
    </p>
    <div class="image-container">
      <img src="./2026-02-28-webchat-message-display.png" alt="Message Display Mockup">
      <p class="image-caption">Figure 4: Message bubble showing image attachment with bug highlight 
      and descriptive text below. Dark theme with rounded corners and subtle shadows.</p>
    </div>

    <h2>4. Keyboard Behavior</h2>
    <div class="key-point">
      <strong>New Keyboard Shortcuts:</strong><br>
      â€¢ <strong>Enter</strong> â€” Insert new line<br>
      â€¢ <strong>Shift+Enter</strong> â€” Insert new line (alternative)<br>
      â€¢ <strong>Ctrl+Enter</strong> â€” Send message<br>
      â€¢ <strong>Cmd+Enter</strong> â€” Send message (Mac)<br>
      â€¢ <strong>Esc</strong> â€” Cancel recording / Clear attachments
    </div>

    <h2>5. Technical Implementation</h2>

    <h3>5.1 File Handling Specifications</h3>
    <table>
      <tr>
        <th>Type</th>
        <th>Max Size</th>
        <th>Storage</th>
        <th>Processing</th>
      </tr>
      <tr>
        <td>Image</td>
        <td>10MB</td>
        <td>Base64 inline</td>
        <td>Preview thumbnail</td>
      </tr>
      <tr>
        <td>Video</td>
        <td>50MB</td>
        <td>Blob URL</td>
        <td>Preview first frame</td>
      </tr>
      <tr>
        <td>Voice</td>
        <td>5 minutes</td>
        <td>Blob URL</td>
        <td>Waveform visualization</td>
      </tr>
    </table>

    <h3>5.2 Message Payload Format</h3>
    <div class="code-block">
{
  "id": "msg-uuid",
  "timestamp": "2026-02-28T15:15:00Z",
  "sender": "user",
  "content": {
    "text": "string or null",
    "attachments": [
      {
        "type": "image|video|audio",
        "name": "filename.jpg",
        "size": 12345,
        "data": "base64-or-blob-url",
        "mimeType": "image/jpeg"
      }
    ]
  }
}
    </div>

    <h3>5.3 Required Browser APIs</h3>
    <ul>
      <li><strong>FileReader</strong> â€” Read files as base64 for preview and transmission</li>
      <li><strong>MediaRecorder</strong> â€” Record voice and video streams</li>
      <li><strong>getUserMedia</strong> â€” Access microphone and camera</li>
      <li><strong>URL.createObjectURL</strong> â€” Generate preview URLs for blobs</li>
    </ul>

    <h2>6. User Flows</h2>

    <h3>6.1 Sending Mixed Message (Text + Screenshot)</h3>
    <div class="flow-diagram">
1. User clicks ðŸ“Ž button â†’ File picker opens<br>
2. User selects screenshot.png â†’ Preview appears in attachment bar<br>
3. User types bug description in text area<br>
4. User presses Ctrl+Enter â†’ Message composed with text + attachment<br>
5. Message sent to AI â†’ AI receives both text and image<br>
6. Message displays in chat â†’ Shows thumbnail + text in same bubble
    </div>

    <h3>6.2 Voice Recording Flow</h3>
    <div class="flow-diagram">
1. User clicks ðŸŽ¤ button â†’ Browser requests mic permission<br>
2. Permission granted â†’ Recording UI appears with red indicator<br>
3. User speaks â†’ Timer counts up, waveform visualizes audio<br>
4. User clicks Stop â†’ Recording ends, preview ready<br>
5. User clicks Send â†’ Voice message transmitted<br>
   (or Cancel â†’ Discard recording)
    </div>

    <h2>7. Before vs After Comparison</h2>
    <div class="comparison">
      <div class="comparison-box before">
        <h4>Before (Current)</h4>
        <ul>
          <li>Single-line input only</li>
          <li>Press Enter = sends immediately</li>
          <li>No media support</li>
          <li>Text-only messages</li>
          <li>Can't describe screenshots</li>
        </ul>
      </div>
      <div class="comparison-box after">
        <h4>After (Proposed)</h4>
        <ul>
          <li>Multi-line textarea</li>
          <li>Ctrl+Enter to send</li>
          <li>Image, video, voice support</li>
          <li>Mixed content messages</li>
          <li>Attach + describe in one go</li>
        </ul>
      </div>
    </div>

    <h2>8. Design Decisions</h2>
    <div class="key-point">
      <strong>Confirmed Design Decisions:</strong><br>
      â€¢ <strong>Voice recording:</strong> Click-to-toggle (click to start, click to stop)<br>
      â€¢ <strong>Video recording:</strong> Inline in chat interface (no modal)<br>
      â€¢ <strong>File size limits:</strong> 10MB images, 50MB video â€” accepted<br>
      â€¢ <strong>Platform:</strong> Mac only â€” no mobile support needed
    </div>

    <h2>9. Implementation Plan (Broken into Sub-Tasks)</h2>
    <p>
      Implementation will proceed in <strong>3 sub-tasks</strong>, each delivering a runnable product 
      for review before proceeding to the next.
    </p>
    <table>
      <tr>
        <th>Sub-Task</th>
        <th>Deliverable</th>
        <th>Demo Checklist</th>
        <th>Est. Time</th>
      </tr>
      <tr>
        <td><strong>1. Input UX</strong></td>
        <td>Textarea input with keyboard shortcuts</td>
        <td>
          â€¢ Multi-line textarea working<br>
          â€¢ Enter inserts new line<br>
          â€¢ Ctrl+Enter sends message<br>
          â€¢ Hint text visible<br>
          â€¢ Demo: Type multi-line text, send
        </td>
        <td>1-2 hours</td>
      </tr>
      <tr>
        <td><strong>2. File Attachments</strong></td>
        <td>File picker + attachment preview + mixed send</td>
        <td>
          â€¢ ðŸ“Ž button opens file picker<br>
          â€¢ Images show preview thumbnails<br>
          â€¢ Can attach + type text together<br>
          â€¢ Ctrl+Enter sends both<br>
          â€¢ Demo: Attach screenshot + describe bug
        </td>
        <td>2-3 hours</td>
      </tr>
      <tr>
        <td><strong>3. Voice Recording</strong></td>
        <td>Inline voice record + playback + send</td>
        <td>
          â€¢ ðŸŽ¤ button starts recording<br>
          â€¢ Click-to-toggle (not hold)<br>
          â€¢ Shows timer + waveform<br>
          â€¢ Preview before send<br>
          â€¢ Demo: Record voice, preview, send
        </td>
        <td>2-3 hours</td>
      </tr>
      <tr>
        <td><strong>Total</strong></td>
        <td colspan="2"></td>
        <td><strong>5-8 hours</strong></td>
      </tr>
    </table>

    <h3>9.1 Sub-Task Workflow</h3>
    <div class="flow-diagram">
Start â†’ Sub-Task 1 (Input UX) â†’ [Demo to Louis]<br>
                        â†“ Approved<br>
           Sub-Task 2 (Attachments) â†’ [Demo to Louis]<br>
                        â†“ Approved<br>
           Sub-Task 3 (Voice) â†’ [Final Demo] â†’ Done
    </div>

    <h2>10. Approval</h2>
    <p>
      <strong>Status:</strong> Awaiting review and approval.<br><br>
      Please review the design mockups above and confirm:<n      <ol>
        <li>Overall approach (unified composer)</li>
        <li>Keyboard behavior (Enter = newline, Ctrl+Enter = send)</li>
        <li>Attachment UI layout</li>
        <li>Voice recording flow</li>
        <li>Answers to open questions</li>
      </ol>
    </p>
    <p>
      Once approved, implementation will begin following the 3-phase plan above.
    </p>

    <div class="footer">
      <p>WebChat UI Enhancement â€” Design Document</p>
      <p>Created: February 28, 2026 | Amy ðŸŒ¸ Ã— Louis</p>
    </div>
  </div>
</body>
</html>
